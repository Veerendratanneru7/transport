@{
    var title = ViewData["Title"] as string ?? "MT";
}
<!doctype html>
@{
    var __lang = (Context.Request?.Query["lang"].ToString() == "ar") ? "ar" : "en";
    var __dir = __lang == "ar" ? "rtl" : "ltr";
}
<html lang="@__lang" dir="@__dir">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>@title · MT</title>

    <!-- Bootstrap + Font Awesome (remove if already in site bundle) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

    <style>
        :root{
          --primary:#7C1D3A; --primary-800:#6D1933; --border:#EED7DE; --tint:#F9F2F4; --text:#4E0F21;
          --sidebar-w: 260px;
        }
        body{font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif; color:#222; background:#fff;}
        .navbar-mto{background:#fff;border-bottom:1px solid var(--border);}
        .navbar-mto .navbar-brand{color:var(--primary);font-weight:800;letter-spacing:.4px;}
        .navbar-mto .nav-link{color:#333;}
        .navbar-mto .nav-link:hover{color:var(--primary);}

        .layout{
          display:grid; grid-template-columns: var(--sidebar-w) 1fr;
          min-height:100vh;
        }
        .sidebar{
          border-right:1px solid var(--border);
          background:#fff; padding:18px; position:sticky; top:0; height:calc(100vh - 56px);
        }
        .sidebar .menu a{
          display:flex; align-items:center; gap:10px; color:#4E0F21; padding:10px 12px; border-radius:10px; text-decoration:none;
        }
        .sidebar .menu a:hover,.sidebar .menu a.active{background:var(--tint); color:var(--primary);}
        .content{padding:24px;}
        .footer{border-top:1px solid var(--border); padding:16px; text-align:center; color:#555; background:#fff;}

        /* mobile */
        @@media (max-width: 991.98px){
          .layout{grid-template-columns: 1fr;}
          .sidebar{position:fixed; left:0; top:56px; width:100%; height:auto; z-index:1040; display:none;}
          .sidebar.show{display:block;}
        }
        .btn-primary{background:var(--primary); border-color:var(--primary);}
        .btn-primary:hover{background:var(--primary-800); border-color:var(--primary-800);}
        .text-primary{color:var(--primary)!important;}
    </style>

    @RenderSection("Head", required: false)
</head>
<body>
    <!-- Top Navbar -->
    <nav class="navbar navbar-expand-lg navbar-mto sticky-top">
        <div class="container-fluid">
            <button class="btn d-lg-none me-2" id="sidebarToggle" aria-label="Menu">
                <i class="fa-solid fa-bars text-primary"></i>
            </button>
            <a class="navbar-brand" href="/">MTO</a>

            <div class="ms-auto d-flex align-items-center gap-2">
                @{
                    // determine current lang from query
                    var currLang = (Context.Request?.Query["lang"].ToString() == "ar") ? "ar" : "en";
                    var path = Context.Request?.Path.Value ?? "/";
                    var q = System.Web.HttpUtility.ParseQueryString(Context.Request?.QueryString.Value ?? "");
                    // Build EN link
                    q.Set("lang", "en");
                    var enHref = path + (q.Count > 0 ? ("?" + q.ToString()) : "");
                    // Build AR link
                    q.Set("lang", "ar");
                    var arHref = path + (q.Count > 0 ? ("?" + q.ToString()) : "");
                }
                <a class="btn btn-outline-secondary btn-sm @(currLang=="en"?"active":"")" href="@enHref">English</a>
                <a class="btn btn-outline-secondary btn-sm @(currLang=="ar"?"active":"")" href="@arHref">العربية</a>
            </div>
        </div>
    </nav>

    <div class="layout">
        <!-- Sidebar -->
        <aside class="sidebar" id="sideNav">
            <div class="menu">
                @{
                    var currLang2 = (Context.Request?.Query["lang"].ToString() == "ar") ? "ar" : "en";
                }
                <a href="@Url.Action("Register","Main", new { lang = currLang2 })" class="active"><i class="fa-solid fa-truck"></i><span>@(currLang2=="ar"?"تسجيل المركبة":"Vehicle Registration")</span></a>
                <a href="#"><i class="fa-solid fa-file-lines"></i><span>@(currLang2=="ar"?"الإرشادات":"Guidelines")</span></a>
                <a href="#"><i class="fa-solid fa-circle-question"></i><span>@(currLang2=="ar"?"الأسئلة الشائعة":"FAQ")</span></a>
                <a href="#"><i class="fa-solid fa-envelope"></i><span>@(currLang2=="ar"?"اتصل بنا":"Contact")</span></a>
            </div>
        </aside>

        <!-- Main content -->
        <main class="content">
            @RenderBody()
        </main>
    </div>

    <footer class="footer">
        © @DateTime.Now.Year MT • Transport Office
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.getElementById('sidebarToggle')?.addEventListener('click', function(){
          document.getElementById('sideNav')?.classList.toggle('show');
        });
    </script>

    @RenderSection("Scripts", required: false)
</body>
</html>
